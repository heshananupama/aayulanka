{% extends "base.html" %}
{% block content %}

<section class="mx-auto max-w-6xl px-4 py-14">
  <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4">
    <div>
      <h1 class="text-3xl font-semibold">Gallery</h1>
      <p class="mt-2 text-slate-600">
        A glimpse of Sri Lanka — iconic destinations, landscapes, and experiences we help you explore.
      </p>
    </div>

    <a href="https://wa.me/94769775395?text=Hi%20Aayu%20Lanka%20Journeys%20—%20I%20want%20to%20plan%20a%20trip!"
       class="inline-flex rounded-xl bg-emerald-500 px-5 py-3 text-sm font-medium text-white hover:bg-emerald-600">
      Plan on WhatsApp
    </a>
  </div>

  <!-- Grid -->
  <div class="mt-10 grid gap-4 sm:grid-cols-2 md:grid-cols-3">
    {% for img in images %}
    <button type="button"
            class="group relative overflow-hidden rounded-2xl border bg-slate-50"
            onclick="openLightbox({{ loop.index0 }})">
      <img src="{{ img.src }}"
           alt="{{ img.alt }}"
           loading="lazy"
           class="h-60 w-full object-cover group-hover:scale-[1.02] transition" />
      <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition"></div>
    </button>
    {% endfor %}
  </div>

  <!-- CTA -->
  <div class="mt-10 rounded-2xl bg-slate-50 border p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
    <div>
      <div class="font-semibold">Want a trip like these?</div>
      <div class="text-slate-600 text-sm mt-1">Send your dates + budget — we’ll build a custom itinerary.</div>
    </div>
    <div class="flex gap-3">
      <a href="tel:+94769775395"
         class="rounded-xl border px-5 py-3 text-sm font-medium hover:bg-white">
        Call
      </a>
      <a href="/contact"
         class="rounded-xl bg-slate-900 text-white px-5 py-3 text-sm font-medium hover:bg-slate-800">
        Submit inquiry
      </a>
    </div>
  </div>
</section>

<!-- Lightbox -->
<div id="lightbox"
     class="fixed inset-0 z-[60] hidden items-center justify-center bg-black/80 p-4"
     onclick="closeLightbox()">
  <div class="relative max-w-5xl w-full" onclick="event.stopPropagation()">

    <!-- Close -->
    <button class="absolute -top-12 right-0 rounded-xl bg-white/10 px-4 py-2 text-white hover:bg-white/20"
            onclick="closeLightbox()">
      ✕ Close
    </button>

    <!-- Prev -->
    <button onclick="prevImage()"
            class="absolute left-0 top-1/2 -translate-y-1/2 rounded-full bg-white/10 p-4 text-white hover:bg-white/20"
            aria-label="Previous image">
      ◀
    </button>

    <!-- Next -->
    <button onclick="nextImage()"
            class="absolute right-0 top-1/2 -translate-y-1/2 rounded-full bg-white/10 p-4 text-white hover:bg-white/20"
            aria-label="Next image">
      ▶
    </button>

    <!-- Image -->
    <img id="lightboxImg"
         src=""
         alt=""
         class="mx-auto w-full max-h-[80vh] object-contain rounded-2xl bg-black" />

    <div id="lightboxCaption" class="mt-3 text-center text-white/90 text-sm"></div>
  </div>
</div>

<script>
  const images = [
    {% for img in images %}
      { src: "{{ img.src }}", alt: "{{ img.alt }}" },
    {% endfor %}
  ];

  let currentIndex = 0;

  function openLightbox(index) {
    currentIndex = index;
    updateLightbox();
    const box = document.getElementById("lightbox");
    box.classList.remove("hidden");
    box.classList.add("flex");
  }

  function closeLightbox() {
    const box = document.getElementById("lightbox");
    box.classList.add("hidden");
    box.classList.remove("flex");
  }

  function updateLightbox() {
    const img = document.getElementById("lightboxImg");
    const cap = document.getElementById("lightboxCaption");
    img.src = images[currentIndex].src;
    img.alt = images[currentIndex].alt || "";
    cap.textContent = images[currentIndex].alt || "";
  }

  function nextImage() {
    currentIndex = (currentIndex + 1) % images.length;
    updateLightbox();
  }

  function prevImage() {
    currentIndex = (currentIndex - 1 + images.length) % images.length;
    updateLightbox();
  }

  // Keyboard navigation
  document.addEventListener("keydown", (e) => {
    const box = document.getElementById("lightbox");
    if (box.classList.contains("hidden")) return;

    if (e.key === "ArrowRight") nextImage();
    if (e.key === "ArrowLeft") prevImage();
    if (e.key === "Escape") closeLightbox();
  });
</script>

{% endblock %}
